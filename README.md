# Python-DVMAutoRuneEnhance

## 目次
+ 概要
+ デモ動画
+ 目的
+ 使用ライブラリ及び役割
+ フローチャート
+ 工夫・苦労した点
+ 残っている改善点
+ 得られたこと/もの

## 概要
  
Pythonとそのライブラリを用い、ゲームの操作を自動化をする。

## デモ動画

[Youtube - ドラゴンビレッジM 自動ルーン強化](https://www.youtube.com/watch?v=fQdml7Xbw2A)

## 目的

+ これまで学習してきたPython自動化関連のアウトプット  
+ 画像処理ライブラリやOCRに興味があり、使用してみたかった。
+ ゲーム内で負担になっていた作業の負担軽減

## 使用ライブラリ及び役割

|コンポーネント名|用途|
|---:|:---:|
|PyAutoGUI|マウスの自動操作|
|OpenCV|マウス操作向けの座標取得、条件判定のための画像比較|
|Pillow|画面キャプチャの取得、画像のトリミング|
|PyOCR|画像から文字情報を取得|
|||

他 numpy 等。

  > マウスやキーボードの自動化に使用

## フローチャート

![フローチャート](https://github.com/StarsandLabo/Python-DVMAutoRuneEnhance/blob/main/program/flowchart_2022-04-17.jpg)  

## 工夫・苦労した点

`◎,○`…効果のあった内容  
`▲`…期待通りに行かなかった点  
`☓`…

### 工夫  
---

+ ### テンプレートマッチングの過検出への対応(近い座標を判別して一つにまとめる)  
    > ◎ 処理量を1/10以下に抑えることができた  
    + はじめはそれほど意味はないかと考えていたが、後になるほどテスト時のレスポンスが短く助かった
    
    > ▲ 座標が間引かれすぎている。  
    + 運用回避可能な範囲  
    + アルゴリズムが不完全と思われるが、調査中  
    
+ ### OCRによって所持金を取得し、ユーザに通知するようにした。  
    > ○ 所持金を通知する仕組みを作ることができた  

    > ▲ 通知内容の妥協  
    + 思ったよりも精度が出なかった  

+ ### コンソール上に出力されるログの可視性への配慮(着色や体裁)  
    > ○ テストやデバッグが非常にやりやすかった  
    > ▲ 改善できるとは思うが、代わりにコードの可視性が落ちる箇所があった  